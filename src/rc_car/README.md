# rc_car ROS package

## List of nodes (/rc_car/scripts/

### dist_finder.py
Takes in laser scan data, to perform two tasks: 
1. calculation error term based on distances
2. sets flags for obstacle detection

- **Subscribed topic**: /scan  **Message type**: sensor_msgs/LaserScan <br />
- **Published topic**: /error  **Message type**: rc_car/pid_input

### control.py
Reads input from error topic to determine what mode it will operate in:
Mode 1: Obstacle avoidance
Mode 2: Drive parallel to wall
Each mode will publish the instructions for the car's steering angle and velocity to the Arduino microcontroller via rosserial

- **Subscribed topic**: /error            **Message type**: rc_car/pid_input <br />
- **Published topic**: /drive_parameters  **Message type**: rc_car/drive_param

### odom_tf.py
Helper node used to translate a geometry_msgs/Odometry into a transform that may be broadcasted to tf. 
For this project, this node uses hector_mapping odometry to link the two coordinate frames: scanmatch_odom to base_frame

- **Subscribed topic**: /scanmatch_odom   **Message type**: geometry_msgs/Odometry <br />
- **Provided tf**: scanmatch_odom -> base_frame


### teleop_to_arduino.py
Used for keyboard control of car and testing purposes. Takes teleop input and converts the message into a steering angle and velocity

**Published topic**: /drive_parameters  **Message type**: rc_car/drive_param


## Launch files

### localization.launch
Performs localization. Loads a map via map_server, feeds hector_mapping odometry as an input to amcl. 

### pid.launch
Used to execute the PID controller

### hector_config.launch
Configuration for hector_mapping to be used in localization task.

### amcl_config.launch
Configuration for amcl to be used in localization

## Message types

### pid_input
```
float32 vel
float32 error
float32 alpha
bool frontBlocked
bool leftBlocked
bool rightBlocked
```

### drive_param
```
float32 velocity
float32 angle
```

## Bagfiles
- Rosbag files are recorded messages were listened on particular topics. Rosbags are helpful in playingback messages offline.

## Maps
- Maps generated by hector_mapping are used in localization via amcl
